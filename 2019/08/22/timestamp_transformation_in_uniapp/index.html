<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Timestamp Transformation in Uniapp | Jerrio's Blog</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/mermaid/8.8.2/mermaid.min.js"></script><script>mermaid.initialize({
  startOnLoad: true
  , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.0"></head><body><header><nav><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/monitor/">Monitor</a></nav></header><main><article><div id="post-bg"><div id="post-title"><h1>Timestamp Transformation in Uniapp</h1><hr></div><div id="post-content"><h2 id="记一次-uniapp-上的时间格式转换"><a href="#记一次-uniapp-上的时间格式转换" class="headerlink" title="记一次 uniapp 上的时间格式转换"></a>记一次 uniapp 上的时间格式转换</h2><p><strong>背景</strong>：当前项目聊天业务需要显示聊天消息的创建时间。在网上搜索一番之后，发现很多都是答非所问，所以决定自己探索一番，并记录下这个有趣的过程。</p>
<p><strong>业务流程</strong>：<br>    1. 客户端发消息时，本地创建聊天对象加到缓存中并渲染给页面<br>    2. 将聊天对象发送给服务器<br>    3. 服务器将聊天对象转发给对方用户</p>
<p>为了实现该功能，我先分别打印了来自 java 后端和 uni-app 获取时间方法的结果。发现他们的格式不一样，如图：</p>
<p><img src="https://img-blog.csdnimg.cn/20190821231519466.png" alt="在这里插入图片描述"></p>
<p>从后端拿到的是 java.util New Date() 之后的原始长整数（我称之为原始时间），<br>而在 uni-app 里直接 new Date() 后，得到是一个经格式化后的长字符串。</p>
<p>我想，按理来说，考虑到客户端时区的差异，我们最好在客户端对原始时间进行解析。<br>而两个用户可能处在不同的时区，所以唯一的方法就是传递原始时间。</p>
<p>所以在uni-app如何获取未经过格式化的原始时间，已经如何解析呢？</p>
<p><img src="https://img-blog.csdnimg.cn/20190821235003442.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODM1NDk2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以看到这边 uni-app 其实给出了很多方法，其中 getTime() 可以获取一个 numeric universal time (我所指的原始时间)。也就是说我们储存和传输这个时间就可以了。<br>那么我们如何解析它呢？<br>经过一段时间的尝试… 我直接提供简单的示范代码吧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">var time &#x3D; new Date().getTime() &#x2F;&#x2F; 获取原始时间<br>&#x2F;&#x2F; 通过服务器接收后...<br>var newTime &#x3D; new Date(time) &#x2F;&#x2F; 把接收到的时间转换为 Date 类型<br>&#x2F;&#x2F; 其实这样就可以了 可以直接通过 Date 类型自带的 get 方法解析，比如：<br>console.log(newTime.getDate());<br>console.log(newTime.getDay());<br></code></pre></td></tr></table></figure>
<p>这是我 getDate() 之后的结果，这样就成功获取并解析到啦。</p>
<p><img src="https://img-blog.csdnimg.cn/20190822001210866.png" alt="在这里插入图片描述啊"><br><strong>END…</strong></p><div id="paginator"></div></div><div id="post-footer"><hr><a href="/2019/11/27/url_parsing_error/">← Prev Url Parsing Error: 小程序页面跳转传参解析错误 —— Unexpected end of JSON input</a><span style="color: #fe2"> | </span><a href="/2018/08/24/hello-world/">Hello World Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: 'W0Y9YCi6j30MgJlvg32vrRv1-gzGzoHsz'
 , appKey: 'Cm6n1aD1AJ4vD2tO8zgcQJRC'
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/logo2.png" alt="Logo"></a><h1 id="Dr"><a href="/">Aka. Jerrio</a></h1><section id="link"><a target="_blank" rel="noopener" href="https://github.com/Jerriodaddy"><i class="fa fa-github"> Github </i></a><span> </span><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41835496"><i class="fa fa-bullseye"> CSDN </i></a><span> </span><a href="mailto:jerrio20@outlook.com"><i class="fa fa-envelope"> jerrio20@outlook.com</i></a></section><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">7</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">6</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">4</span></div></section></div><div id="aside-block"></div><footer><nobr><span class="text-title">©</span><span class="text-content">1970 to 9999</span></nobr><wbr><nobr><span class="text-title">ICP</span><span class="text-content">——备案号——</span></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>